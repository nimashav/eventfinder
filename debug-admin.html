<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EventWave - Debug Login</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
    }

    .container {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      color: #333;
    }

    .button {
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px;
      transition: transform 0.2s;
    }

    .button:hover {
      transform: translateY(-2px);
    }

    .result {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      border-left: 4px solid #6366f1;
      background-color: #f8fafc;
      white-space: pre-wrap;
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }

    .success {
      border-left-color: #10b981;
      background-color: #f0fdf4;
    }

    .error {
      border-left-color: #ef4444;
      background-color: #fef2f2;
    }

    .instructions {
      background-color: #fffbeb;
      border: 1px solid #fed7aa;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }

    .step {
      margin: 15px 0;
      padding: 10px;
      background-color: #f3f4f6;
      border-radius: 6px;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>🔍 EventWave Admin Debug Tool</h1>
      <p>Use this tool to verify admin login and profile access</p>
    </div>

    <div class="instructions">
      <h3>📋 Follow These Steps:</h3>
      <div class="step">
        <strong>Step 1:</strong> Click "Test Admin Login" button below
      </div>
      <div class="step">
        <strong>Step 2:</strong> If login succeeds, go to <a href="http://localhost:3000"
          target="_blank">http://localhost:3000</a>
      </div>
      <div class="step">
        <strong>Step 3:</strong> Look for your avatar in the top-right corner
      </div>
      <div class="step">
        <strong>Step 4:</strong> Click the avatar to see the dropdown menu
      </div>
      <div class="step">
        <strong>Step 5:</strong> Look for "Profile" option in the menu
      </div>
    </div>

    <div style="text-align: center;">
      <button class="button" onclick="testAdminLogin()">🔑 Test Admin Login</button>
      <button class="button" onclick="testProfileAccess()">👤 Test Profile Access</button>
      <button class="button" onclick="clearResults()">🧹 Clear Results</button>
    </div>

    <div id="results"></div>
  </div>

  <script>
    const API_BASE = 'http://localhost:5002/api';
    let authToken = null;

    function log(message, type = 'info') {
      const results = document.getElementById('results');
      const div = document.createElement('div');
      div.className = `result ${type}`;
      div.textContent = message;
      results.appendChild(div);
      results.scrollTop = results.scrollHeight;
    }

    function clearResults() {
      document.getElementById('results').innerHTML = '';
    }

    async function testAdminLogin() {
      log('🔑 Testing Admin Login...', 'info');

      try {
        const response = await fetch(`${API_BASE}/auth/login`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            email: 'admin@eventwave.com',
            password: 'Admin123!'
          })
        });

        const data = await response.json();

        if (response.ok && data.success) {
          authToken = data.data.token;
          log(`✅ Login Successful!
👤 Name: ${data.data.user.fullName}
📧 Email: ${data.data.user.email}
👑 Role: ${data.data.user.role}
🔑 Token: ${authToken.substring(0, 20)}...

🎯 Next Steps:
1. Open http://localhost:3000 in a new tab
2. Login with: admin@eventwave.com / Admin123!
3. Look for your avatar in the top-right corner
4. Click it to see the dropdown menu
5. Check if "Profile" option is visible`, 'success');
        } else {
          log(`❌ Login Failed: ${data.message}`, 'error');
        }
      } catch (error) {
        log(`❌ Login Error: ${error.message}`, 'error');
      }
    }

    async function testProfileAccess() {
      if (!authToken) {
        log('⚠️ Please login first before testing profile access', 'error');
        return;
      }

      log('👤 Testing Profile Access...', 'info');

      try {
        const response = await fetch(`${API_BASE}/auth/me`, {
          headers: { 'Authorization': `Bearer ${authToken}` }
        });

        const data = await response.json();

        if (response.ok && data.success) {
          log(`✅ Profile Access Successful!
📋 Profile Data:
   📧 Email: ${data.data.user.email}
   🏷️ First Name: ${data.data.user.firstName}
   🏷️ Last Name: ${data.data.user.lastName}
   📱 Phone: ${data.data.user.phone || 'Not set'}
   👑 Role: ${data.data.user.role}
   📅 Created: ${new Date(data.data.user.createdAt).toLocaleDateString()}

✨ Profile endpoint is working correctly!
The backend is ready for the frontend to display profile information.`, 'success');
        } else {
          log(`❌ Profile Access Failed: ${data.message}`, 'error');
        }
      } catch (error) {
        log(`❌ Profile Error: ${error.message}`, 'error');
      }
    }

    // Auto-run login test when page loads
    window.onload = function () {
      log('🚀 EventWave Debug Tool Ready!', 'info');
      log('Backend URL: ' + API_BASE, 'info');
      log('Frontend URL: http://localhost:3000', 'info');
      log('Click "Test Admin Login" to start debugging', 'info');
    };
  </script>
</body>

</html>